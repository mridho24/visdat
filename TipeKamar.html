<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Room Type Analysis</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }

        .visualization-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .chart-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 50px;
            margin: 20px auto;
            max-width: 800px;
        }

        .chart {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .chart:hover {
            transform: translateY(-5px);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .insight-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid #eef2f7;
        }

        .insight-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }

        .insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .insight-icon {
            font-size: 24px;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 10px;
        }

        .insight-title {
            font-size: 16px;
            color: #2c3e50;
            margin: 0;
            font-weight: 600;
        }

        .insight-value {
            font-size: 28px;
            color: #3498db;
            font-weight: bold;
            margin: 10px 0;
        }

        .insight-description {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }

        .trend-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            margin-top: 10px;
        }

        .trend-up {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .trend-down {
            background: #ffebee;
            color: #c62828;
        }

        .tooltip {
            position: absolute;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            pointer-events: none;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Analisis Tipe Kamar Hotel</h2>

        <div class="visualization-container">
            <div id="roomTypeChart"></div>
        </div>

        <div class="chart-grid">
            <div class="chart" id="roomMatchChart"></div>
            <div class="chart" id="upgradeChart"></div>
        </div>

        <div class="insights-grid">
            <div class="insight-card">
                <div class="insight-header">
                    <span class="insight-icon">üè®</span>
                    <h4 class="insight-title">Tipe Kamar Dominan</h4>
                </div>
                <div class="insight-value">Tipe A</div>
                <p class="insight-description">
                    79.1% dari total pemesanan, menunjukkan preferensi yang kuat
                </p>
                <div class="trend-indicator trend-up">‚Üë Most Popular</div>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <span class="insight-icon">‚ú®</span>
                    <h4 class="insight-title">Kesesuaian Kamar</h4>
                </div>
                <div class="insight-value">96.8%</div>
                <p class="insight-description">
                    Tamu mendapatkan tipe kamar sesuai pesanan
                </p>
                <div class="trend-indicator trend-up">‚Üë High Match Rate</div>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <span class="insight-icon">‚¨ÜÔ∏è</span>
                    <h4 class="insight-title">Rasio Upgrade</h4>
                </div>
                <div class="insight-value">62.5%</div>
                <p class="insight-description">
                    Dari total perubahan tipe kamar, mayoritas adalah upgrade
                </p>
                <div class="trend-indicator trend-up">‚Üë Customer Satisfaction</div>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <span class="insight-icon">üìä</span>
                    <h4 class="insight-title">Distribusi Kamar</h4>
                </div>
                <div class="insight-value">6.4 : 1</div>
                <p class="insight-description">
                    Rasio pemesanan Tipe A dibanding Tipe D
                </p>
                <div class="trend-indicator trend-up">‚Üë Clear Preference</div>
            </div>
        </div>
    </div>

    <script>
        // Data preparation
        const roomTypeData = [
            { type: 'A', count: 7910, percentage: 79.1 },
            { type: 'D', count: 1230, percentage: 12.3 },
            { type: 'E', count: 320, percentage: 3.2 },
            { type: 'F', count: 210, percentage: 2.1 },
            { type: 'G', count: 180, percentage: 1.8 },
            { type: 'H', count: 150, percentage: 1.5 }
        ];

        const roomMatchData = [
            { status: 'Sesuai', count: 9680, percentage: 96.8 },
            { status: 'Tidak Sesuai', count: 320, percentage: 3.2 }
        ];

        const upgradeDowngradeData = [
            { type: 'Upgrade', count: 200, percentage: 62.5 },
            { type: 'Downgrade', count: 120, percentage: 37.5 }
        ];

        // Set up dimensions and margins
        const margin = { top: 40, right: 30, bottom: 80, left: 100 };
        const barChartWidth = 900 - margin.left - margin.right;
        const barChartHeight = 400 - margin.top - margin.bottom;
        const pieChartWidth = 350;  // Increased from 300
        const pieChartHeight = 350; // Increased from 300
        const pieRadius = Math.min(pieChartWidth, pieChartHeight) / 2 - 40; // Added more padding

        // Color scales
        const colorScale = d3.scaleSequential(d3.interpolateViridis)
            .domain([0, roomTypeData.length - 1]);

        const matchColor = d3.scaleOrdinal()
            .domain(['Sesuai', 'Tidak Sesuai'])
            .range(['#2ca02c', '#d62728']);

        const upgradeColor = d3.scaleOrdinal()
            .domain(['Upgrade', 'Downgrade'])
            .range(['#2ca02c', '#d62728']);

        // Tooltip setup
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // 1. Room Type Bar Chart
        const barSvg = d3.select("#roomTypeChart")
            .append("svg")
            .attr("width", barChartWidth + margin.left + margin.right)
            .attr("height", barChartHeight + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // X scale
        const x = d3.scaleLinear()
            .domain([0, d3.max(roomTypeData, d => d.count)])
            .range([0, barChartWidth]);

        // Y scale
        const y = d3.scaleBand()
            .domain(roomTypeData.map(d => d.type))
            .range([0, barChartHeight])
            .padding(0.2);

        // Add bars
        barSvg.selectAll(".bar")
            .data(roomTypeData)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", 0)
            .attr("y", d => y(d.type))
            .attr("width", d => x(d.count))
            .attr("height", y.bandwidth())
            .attr("fill", (d, i) => colorScale(i))
            .on("mouseover", function(event, d) {
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                tooltip.html(`Tipe Kamar ${d.type}<br>Jumlah: ${d.count.toLocaleString()}<br>Persentase: ${d.percentage}%`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function() {
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
            });

        // Add value labels
        barSvg.selectAll(".label")
            .data(roomTypeData)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("x", d => x(d.count) + 5)
            .attr("y", d => y(d.type) + y.bandwidth() / 2)
            .attr("dy", ".35em")
            .text(d => `${d.count.toLocaleString()} (${d.percentage}%)`)
            .style("font-size", "12px")
            .style("fill", "#555");

        // Add axes
        barSvg.append("g")
            .attr("class", "x axis")
            .attr("transform", `translate(0,${barChartHeight})`)
            .call(d3.axisBottom(x).ticks(5).tickFormat(d => d.toLocaleString()))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", ".15em")
            .attr("transform", "rotate(-45)");

        barSvg.append("g")
            .attr("class", "y axis")
            .call(d3.axisLeft(y));

        // Add X axis label
        barSvg.append("text")
            .attr("x", barChartWidth / 2)
            .attr("y", barChartHeight + margin.bottom - 10)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .text("Jumlah Pemesanan");

        // Add Y axis label
        barSvg.append("text")
            .attr("transform", "rotate(-90)")
            .attr("x", -barChartHeight / 2)
            .attr("y", -margin.left + 20)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .text("Tipe Kamar");

        // Add chart title
        barSvg.append("text")
            .attr("x", barChartWidth / 2)
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .style("font-weight", "bold")
            .text("Distribusi Tipe Kamar yang Dipesan");

        // 2. Room Match Pie Chart
        const pieSvg1 = d3.select("#roomMatchChart")
            .append("svg")
            .attr("width", pieChartWidth)
            .attr("height", pieChartHeight)
            .append("g")
            .attr("transform", `translate(${pieChartWidth / 2},${pieChartHeight / 2})`);

        const pie = d3.pie()
            .value(d => d.count)
            .sort(null);

        const arc = d3.arc()
            .innerRadius(0)
            .outerRadius(pieRadius);

        const arcs1 = pieSvg1.selectAll(".arc")
            .data(pie(roomMatchData))
            .enter()
            .append("g")
            .attr("class", "arc");

        arcs1.append("path")
            .attr("d", arc)
            .attr("fill", d => matchColor(d.data.status))
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .on("mouseover", function(event, d) {
                d3.select(this).attr("stroke-width", 2);
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                tooltip.html(`${d.data.status}<br>Jumlah: ${d.data.count.toLocaleString()}<br>Persentase: ${d.data.percentage}%`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function() {
                d3.select(this).attr("stroke-width", 1);
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
            });

        // Add labels to pie chart
        arcs1.append("text")
            .attr("transform", d => `translate(${arc.centroid(d)})`)
            .attr("dy", "0.35em")
            .attr("text-anchor", "middle")
            .text(d => `${d.data.status} (${d.data.percentage}%)`)
            .style("font-size", "12px")
            .style("fill", "white");

        // Add pie chart title
        pieSvg1.append("text")
            .attr("x", 0)
            .attr("y", -pieChartHeight / 2 + 20)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("font-weight", "bold")
            .text("Kecocokan Tipe Kamar");

        // 3. Upgrade/Downgrade Pie Chart
        const pieSvg2 = d3.select("#upgradeChart")
            .append("svg")
            .attr("width", pieChartWidth)
            .attr("height", pieChartHeight)
            .append("g")
            .attr("transform", `translate(${pieChartWidth / 2},${pieChartHeight / 2})`);

        const arcs2 = pieSvg2.selectAll(".arc")
            .data(pie(upgradeDowngradeData))
            .enter()
            .append("g")
            .attr("class", "arc");

        arcs2.append("path")
            .attr("d", arc)
            .attr("fill", d => upgradeColor(d.data.type))
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .on("mouseover", function(event, d) {
                d3.select(this).attr("stroke-width", 2);
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                tooltip.html(`${d.data.type}<br>Jumlah: ${d.data.count.toLocaleString()}<br>Persentase: ${d.data.percentage}%`)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function() {
                d3.select(this).attr("stroke-width", 1);
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
            });

        // Add labels to pie chart
        arcs2.append("text")
            .attr("transform", d => `translate(${arc.centroid(d)})`)
            .attr("dy", "0.35em")
            .attr("text-anchor", "middle")
            .text(d => `${d.data.type} (${d.data.percentage}%)`)
            .style("font-size", "12px")
            .style("fill", "white");

        // Add pie chart title
        pieSvg2.append("text")
            .attr("x", 0)
            .attr("y", -pieChartHeight / 2 + 20)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("font-weight", "bold")
            .text("Upgrade vs Downgrade");
    </script>
    <a href="index.html" class="back-button">
        <span>‚Üê</span> Kembali ke Menu
    </a>
</body>
</html>